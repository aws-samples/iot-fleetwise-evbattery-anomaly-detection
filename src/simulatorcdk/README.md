# iot-fleetwise-evbattery-anomaly-detection/simulatorcdk

Placeholder

# Install


## AWS Resources 
This CDK App spins up two CloudFormation stacks when deployed to your AWS account, plus a few for bootstrapping/resources needed by Builder Tools systems.

- ECS Cluster Stack. This stack includes the 1) vpc with maximum 3 AZs. 2) Security Group. 3) EC2 Launch Template. 4) EC2 ASG. 5) ECS Cluster and capacity provider
- ECS Task Stack. This contains the task definition to perform Edge agent simulation and output logs to CloudWatch

We decouple ECS task stack from cluster stack to allow developers to create their own task stack and reuse the same cluster. 

A quick tour of this package's contents

./ecs-cluster.ts - This script is used to create AWS resources for ECS Cluster
./ecs-task.ts - This script is used to create AWS resources for ECS Task
./ec2-image-updater.ts - This script creates Image Builder Pipeline which periodically check if there's new update from Ubuntu.
./ec2-image-updater.yaml - The yaml file comes from AWS ECS auto update reference on GitHub.
./ec2-setup-scripts/al2-kernel-5/ec2-ami-setup.sh - Bash script for User Data section of Image Builder Component used to build custom EC2 Image with Amazon Linux 2 Kernel 5.10
./ec2-setup-scripts/al2-kernel-5/ec2-launch-with-custom-ami.sh - Bash script for User Data section of EC2 launching with custom AMI generated by Image Build Pipeline above
./ec2-setup-scripts/ubuntu-20-lts/ec2-ami-setup.sh - Bash script for User Data section of Image Builder Component used to build custom EC2 Image with Ubuntu 20.04
./ec2-setup-scripts/ubuntu-20-lts/ec2-launch-with-custom-ami.sh - Bash script for User Data section of EC2 launching with custom AMI generated by Image Build Pipeline above
./LifecycleLaunchLambda/index.py - AWS Lambda function source code to handle ECS EC2 instance launch activity.
./LifecycleTerminateLambda/index.py - AWS Lambda function source code to handle ECS EC2 instance terminate activity.


## Getting started